---
title: "Approach: Equivalence Problems as Energy Games"
---

{{< include style/macros.md >}}

Purpose of section:

- Introduce energy games
- Illustrate approach

## Energy Games

### General Energy Games

To introduce energy games, we generalize the definitions on games (@def-game and the following) to include *energy levels*.

::: {#def-energy-game}
#### Energy Reachability Game

Given a partially ordered set of energies $(\abstractenergies, \leq)$, an *energy reachability game* $\game^ğŸ—²$ is a reachability game $(G, G_\defender, \gamemoveblank)$ extended by an edge labeling of energy updates $\abstractupdate \colon (\gamemoveblank) \to (\abstractenergies \to (\set{âŠ¥} \cup \abstractenergies))$.

{{<noindent>}} We denote by $\game^ğŸ—²[g_0, e_0]$ the game played from starting position $g_0 âˆˆ G$ with initial energy level $e_0 âˆˆ \abstractenergies$.
:::

::: {#def-energy-level}
#### Energy Level

For a finite play $Ï = {g_0}{g_1}â€¦{g_{n-1}} âˆˆ G^{*}$ of $\game^ğŸ—²[g_0, e_0]$, its energy level $\energylevel(Ï)$ is computed recursively:

- $\energylevel(g_0) â‰” e_0$
- $\energylevel(g_0â€¦{g_{i+1}}) â‰”
  \begin{cases}
    \abstractupdate({g_{i}},{g_{i+1}})(\energylevel(g_0â€¦{g_{i}})) & \text{if } \energylevel(g_0â€¦{g_{i}}) \neq âŠ¥ \\
    âŠ¥  & \text{otherwise}
  \end{cases}$

{{<noindent>}} For infinite plays $Ï \in G^Ï‰$, we define energy levels to equal $âŠ¥$.

We consider the attacker to be energy-bound and understand $\energylevel(Ï) = âŠ¥$ to mean that they have run out of energy.
Thus, we declare plays with $\energylevel(Ï) = âŠ¥$ to be won by the defender.
:::

We lift positional strategies of @def-strategies to be *energy-positional* in the sense that they pick next moves depending on the current energy level, i.e.\ $\rel F âŠ† (G_\attacker Ã— \abstractenergies Ã— G)$.

Instead of a winning region as in @def-winning-region, we define *winning budgets* for game positions:

::: {#def-winning-budgets}
#### Winning Budgets

For each position $g_0 \in G$ of energy game $\game^ğŸ—²$, the *attacker winning energy budgets*, $\attackerwins(g_0) \subseteq \abstractenergies$ are the energies $e_0$ where the attacker wins $\game^ğŸ—²[g_0, e_0]$.
The defender winning budgets $\defenderwins$ are defined analogously.
:::

::: {#rem-energy-reachability}
Ordinary reachability games can be seen as a special case of energy games with trivial energies, e.g.\ $\abstractenergies â‰” \set{1}$ and $\abstractupdate(\cdot) â‰” \identity{\abstractenergies}$.
:::

TODO: Example plus-minus energy game. ... Upward-closure

### Declining Energy Games

An $N$-dimensional declining energy game is played on energy vectors:

::: {#def-energy-updates}

#### Energies and Energy Updates

For a dimensionality $N$, the set of *energies*, $\energies$, is given by $(\nats \cup \set{\infty})^N$.

The set of *energy update labels*, $\energyupdates$, contains $\vectorcomponents[N]{u} \in \energyupdates$ where each component $u_k$ is a symbol of the form

- $u_k \in \set{-1, 0}$ (relative update), or
- $u_k = \mathtt{min}_D$ where $D \subseteq \{1, \ldots, 8\}$ and $k \in D$ (minimum selection update).

{{<noindent>}} Applying an update to an energy, $\energyupdate(e, u)$, where $e = \vectorcomponents[N]{e} \in \energies$ and $u = \vectorcomponents[N]{u} \in \energyupdates$, yields a new energy vector $e'$ where $k$th components $e'_k â‰” e_k + u_k$ for $u_k \in \ints$ and $e'_k â‰” \min_{d\in D} e_d$ for $u_k = \mathtt{min}_D$.
Updates that would cause any component to become negative are undefined, i.e., $\energyupdate$ is a partial function.
:::

::: {#exm-energy-update}

For example, the update $\energyupdate((2,0,\infty,0,0,0,1,1), (\updmin{1,7},0,-1,0,0,0,0,-1))$ equals $(1,0,\infty,0,0,0,1,0)$.
:::

::: {#def-declining-energy-game}
#### Declining Energy Game

Given a weight labeling $w \colon (\gamemoveblank) \to \energyupdates$, an $N$-dimensional *declining energy game* $\game^ğŸ—²$ is an energy reachability game with energies $\abstractenergies â‰” \energies$ and with edges labeled $\abstractupdate(m) â‰” \energyupdate(w(m), \cdot)$.

We write $g \gamemove{\;u\;} g'$ for a move $g \gamemoveblank g'$ labeled by weight $w(g, g') = u$.
:::

Upward closure

## A Bisimulation Energy Game

Let us recall the bisimulation game of @def-bisim-game.
As we have seen in Subsection [-@sec-bisim-game-hml], the game moves match the distinctive power of productions in the $\observations{\floor{B}}$-grammar of @exm-game-formulas.

Consequently, we can *count* the use of HML constructs in the game.
As the game stands, we can meaningfully count: 1.\ modal depth, 2.\ depth of negative clauses, and 3.\ nesting depth of negations (that is, the first, fifth and sixth dimension of the strong spectrum @def-strong-spectrum).
Adding the respective energy updates to the bisimulation game, we obtain:

<!--
$$
\begin{array}{rcll}
  Ï†^N
    & \grammardef & \hmlobs{Î±} \hmland{i}{I} Ï†^{N-\unit{1}}_i \\
    & \grammaror  & \hmlneg Ï†^{ (N \sqcap (N_2, \infty, \infty)) - \unit{3} }
\end{array}
$$
-->

::: {#def-bisim-energy-game}
#### Bisimulation Energy Game

For a transition system $\system$, the *bisimulation energy game* ${\game}_\notionname{B}^{ğŸ—²\system}$ is played on the same graph as the *bisimulation game* ${\game}_\notionname{B}^{\system}$ (of @def-bisim-game), but the moves are weighted by the following energy updates:

- The attacker may swap sides
  $$[p, q] \quad \gamemove{\updmin{1,2},0,-1}^ğŸ—²_\notionname{B} \quad [q, p],$$
- or challenge simulation
  $$[p, q] \quad \gamemove{-1,0,0}^ğŸ—²_\notionname{B} \quad (Î±, p', q) \quad \text{if} \quad p \step{Î±} p';$$
- and the defender answers simulation challenges
  $$(Î±, p', q) \quad \gamemove{0,0,0}^ğŸ—²_\notionname{B} \quad (p', q') \quad \text{if} \quad q \step{Î±} q'.$$
:::

Depending on the initial energy level, 

::: {#exm-bisim-sim-energy-game}

Let us label the bisimulation game of @#exm-bisim-sim-game (distinguishing the â€œtrolled philosophersâ€) with energy updates:

TODO

:::

::: {#lem-bisim-energy-game-characterizations}


TODO: Discussion of characterized eqs

:::

## How to Decide Declining Energy Games

- TODO: Refined algo for energy games
- TODO: Complexities
